---
import MainLayout from '../../layouts/MainLayout.astro';

interface MarkdownModule {
  frontmatter: {
    title: string;
    date: string;
    description?: string;
  };
  Content: any;
}

// Generar rutas para todos los posts
export async function getStaticPaths() {
  const posts = import.meta.glob('../../content/polizas/*.md', { eager: true });
  
  return Object.keys(posts).map((path) => {
    const slug = path.split('/').pop()!.replace('.md', '');
    return { params: { slug } };
  });
}

// Obtener el slug de la URL
const { slug } = Astro.params;

// Cargar el post correspondiente
const posts = import.meta.glob('../../content/polizas/*.md', { eager: true });
const postModule = posts[`../../content/polizas/${slug}.md`] as MarkdownModule;

if (!postModule) {
  throw new Error(`Post no encontrado: ${slug}`);
}
---

<MainLayout title={postModule.frontmatter.title}>
  <article class="max-w-4xl mx-auto px-6 py-16 text-balance leading-relaxed bg-white text-black font-poppins rounded-lg">
    <h1 class="mb-6 font-extrabold text-4xl font-raleway text-dorado-secundario">
      {postModule.frontmatter.title}
    </h1>
    <time
      class="block mb-8 text-sm text-gray-500 dark:text-gray-400"
      datetime={postModule.frontmatter.date}
    >
      {new Date(postModule.frontmatter.date).toLocaleDateString(undefined, {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
      })}
    </time>

    <postModule.Content />
  </article>
</MainLayout>
